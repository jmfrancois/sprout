var te=Object.defineProperty;var ne=(t,e,n)=>e in t?te(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var c=(t,e,n)=>ne(t,typeof e!="symbol"?e+"":e,n);import{j as i}from"./jsx-runtime-Nms4Y4qS.js";import{u as se,F as ie}from"./useFieldAriaProps-DGTkAVsv.js";import{u as oe,b as re,o as ae,f as le,n as ue,g as de,h as ce,F as pe}from"./floating-ui.react-BqcbUs5N.js";import{r as u}from"./index-BwDkhjyp.js";import{P as S}from"./constant-DXShcaho.js";import{c as z}from"./Box-Bo_17ADl.js";import{D as fe}from"./DropdownArrowIcon-B9DU0KGM.js";import{E as me}from"./ErrorIcon-B-FaR8fG.js";import{m as H,M as D}from"./Menu-D0QU6eyN.js";import{u as F}from"./useId-Nx1NlIzw.js";import{u as ge}from"./useControl-BksuLBKc.js";function T(){return document.querySelectorAll("empty-not-existing")}const A="data-hovered";class he{constructor(e){c(this,"isOpen");c(this,"onOpenChange");c(this,"onChange");c(this,"element");c(this,"listbox");c(this,"getAllItems");c(this,"_getAllItems");c(this,"getSelectedItems");c(this,"_getSelectedItems");c(this,"loop");c(this,"_handler");c(this,"onEnter");this.isOpen=e.isOpen,this.onOpenChange=e.onOpenChange,this.onChange=e.onChange,this.getAllItems=e.getAllItems,this.getSelectedItems=e.getSelectedItems,this.loop=e.loop===void 0?!0:e.loop,this._getSelectedItems=()=>this.listbox&&this.getSelectedItems?this.getSelectedItems(this.listbox):T(),this._getAllItems=()=>this.listbox?this.getAllItems(this.listbox):T()}setElement(e){this.removeEventListener(),this.element=void 0,e&&(this.element=e,this.addEventListener())}getListInfo(){const e={selected:T(),all:T(),focus:void 0,focusIndex:-1,lastIndex:-1};if(!this.element)return e;e.all=this._getAllItems(),e.selected=this._getSelectedItems(),e.lastIndex=e.all.length-1;const n=e.all.values();let s,r=-1;do{const{value:o,done:l}=n.next();r+=1,s=!l,o&&(o.getAttribute(A)==="true"?(e.focus=o,e.focusIndex=r):o.setAttribute(A,"false"))}while(s);return e}focusOnNextItem(){const e=this.getListInfo();if(e.focusIndex===-1){this.focusOn(e,0);return}e.focusIndex===e.lastIndex?this.loop&&this.focusOn(e,0):typeof e.focusIndex=="number"&&this.focusOn(e,e.focusIndex+1)}focusOnPreviousItem(){const e=this.getListInfo();if(e.focusIndex===-1){this.focusOn(e,0);return}e.focusIndex===0?this.loop&&this.focusOn(e,e.lastIndex):this.focusOn(e,e.focusIndex-1)}focusOnNextPageItem(){const e=this.getListInfo();e.focusIndex+S>=e.lastIndex?this.focusOn(e,e.lastIndex):this.focusOn(e,e.focusIndex+S)}focusOnPreviousPageItem(){const e=this.getListInfo();e.focusIndex-S<0?this.focusOn(e,0):this.focusOn(e,e.focusIndex-S)}onKeyDownHandler(e){if(this.element)switch(e.key){case"Enter":if(this.onEnter){const n=this.getListInfo();this.onEnter(n.focus)}break;case"Escape":!this.isOpen&&this.onEnter&&this.onEnter();break;case"Tab":this.isOpen&&(e.stopPropagation(),e.preventDefault(),this.onOpenChange(!1));break;case"Down":case"ArrowDown":e.stopPropagation(),e.preventDefault(),this.isOpen?this.focusOnNextItem():this.onOpenChange(!0);break;case"Up":case"ArrowUp":e.stopPropagation(),e.preventDefault(),this.focusOnPreviousItem();break;case"Home":e.stopPropagation(),e.preventDefault(),this.focusOnFirst();break;case"End":e.stopPropagation(),e.preventDefault(),this.focusOnLast();break;case"PageDown":e.stopPropagation(),e.preventDefault(),this.focusOnNextPageItem();break;case"PageUp":e.stopPropagation(),e.preventDefault(),this.focusOnPreviousPageItem();break}}addEventListener(){this.element&&(this._handler=e=>this.onKeyDownHandler(e),this.element.addEventListener("keydown",this._handler))}removeEventListener(){this.element&&this._handler&&(this.element.removeEventListener("keydown",this._handler),this._handler=void 0)}focusOnFirst(){const e=this.getListInfo();this.focusOn(e,0)}focusOnLast(){const e=this.getListInfo();this.focusOn(e,e.lastIndex)}focusOn(e,n){if(n<0||n>e.lastIndex)return;const s=e.all[n];s&&(s.setAttribute(A,"true"),s.scrollIntoView(),this.onChange(s),e.focusIndex!==-1&&e.focusIndex!==n&&e.all[e.focusIndex].setAttribute(A,"false"),e.focusIndex=n)}focusOnFirstSelected(){const e=this.getListInfo(),n=e.selected[0];if(n){const s=Array.from(e.all).indexOf(n);this.focusOn(e,s)}else this.focusOn(e,0)}}function ye(t){const[e,n]=u.useState();return u.useMemo(()=>{if(e)return e.onOpenChange!==t.onOpenChange&&(e.onOpenChange=t.onOpenChange),e.isOpen!==t.isOpen&&(e.isOpen=t.isOpen),e.getAllItems!==t.getAllItems&&(e.getAllItems=t.getAllItems),e.getSelectedItems!==t.getSelectedItems&&(e.getSelectedItems=t.getSelectedItems),e.loop!==t.loop&&t.loop!==void 0&&(e.loop=t.loop),e;const r=new he(t);return n(r),r},[t.getAllItems,t.getSelectedItems,t.loop,t.isOpen,t.onOpenChange])}const ve="_input_y48ay_1",xe="_pressed_y48ay_19",Ie="_value_y48ay_23",be="_placeholder_y48ay_48",Oe="_small_y48ay_55",_e="_dd_icon_y48ay_59",Ce="_dd_icon_open_y48ay_63",qe="_option_icon_y48ay_67",Se="_error_y48ay_74",h={input:ve,pressed:xe,value:Ie,placeholder:be,small:Oe,dd_icon:_e,dd_icon_open:Ce,option_icon:qe,error:Se},E=u.forwardRef(({id:t,size:e,label:n,hasError:s,isOpen:r,"aria-controls":o,iconElement:l,placeholder:p,disabled:y,value:x,...O},_)=>{const I=u.useRef(null);return u.useEffect(()=>{l&&I.current&&(I.current.innerHTML="",I.current.appendChild(l.cloneNode(!0)))},[l]),i.jsx(i.Fragment,{children:i.jsxs("button",{...O,id:t,"aria-label":n||p,disabled:y,role:"combobox","aria-controls":o,"aria-expanded":r?"true":"false",...O,ref:_,type:"button",className:z(h.input,{[h.small]:e==="small",[h.error]:s,[h.pressed]:r}),children:[l?i.jsx("svg",{className:h.option_icon,ref:I}):null,x&&n&&i.jsx("span",{className:h.value,children:n}),!x&&i.jsx("span",{className:h.placeholder,children:p}),s&&i.jsx(me,{}),i.jsx("svg",{viewBox:"0 0 16 16",width:"16",height:"16",className:z(h.dd_icon,{[h.dd_icon_open]:r}),children:i.jsx(fe,{className:h.dd_icon})})]})})});E.displayName="Combobox";E.__docgenInfo={description:"",methods:[],displayName:"Combobox",props:{isDisplayedForTesting:{required:!1,tsType:{name:"boolean"},description:""},iconElement:{required:!1,tsType:{name:"SVGSVGElement"},description:""},hasError:{required:!1,tsType:{name:"boolean"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:""},size:{required:!1,tsType:{name:"union",raw:'"default" | "small"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"small"'}]},description:""},"aria-controls":{required:!0,tsType:{name:"string"},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"string"},description:""},label:{required:!1,tsType:{name:"string"},description:""},defaultValue:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: ChangeEvent) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  target: {
    name: string;
    value: string;
  };
}`,signature:{properties:[{key:"target",value:{name:"signature",type:"object",raw:`{
  name: string;
  value: string;
}`,signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}}]},required:!0}}]}},name:"e"}],return:{name:"void"}}},description:""}}};const K=u.createContext(void 0);function Te({children:t,...e},n){return i.jsx("div",{ref:n,className:H.menu,role:"listbox",...e,children:t})}const w=u.forwardRef(Te);w.displayName="Listbox";w.__docgenInfo={description:"",methods:[],displayName:"Listbox",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""},id:{required:!0,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"CSSProperties"},description:""},"aria-labelledby":{required:!0,tsType:{name:"string"},description:""}}};function j(){return i.jsx(D.Divider,{})}j.displayName="Divider";j.__docgenInfo={description:"",methods:[],displayName:"Divider"};function Ae({children:t,...e},n){return t?i.jsx(D.Group,{...e,ref:n,children:t}):null}const N=u.forwardRef(Ae);N.displayName="OptGroup";N.__docgenInfo={description:"",methods:[],displayName:"OptGroup"};const b=u.forwardRef(({id:t,...e},n)=>{const s=F(t),r=u.useContext(K),{value:o,label:l,icon:p,...y}=e;return i.jsx("button",{type:"button",id:s,ref:n,className:H.menuitem,role:"option",tabIndex:-1,"aria-selected":r===o?"true":"false","data-option":o,"data-option-label":l,...y,children:i.jsx(D.Content,{selectable:!0,selected:r===o,label:l,icon:p})})});b.displayName="Option";function Ee(t){return typeof t=="string"?"option":t.type?t.type:"option"}function P({options:t}){return i.jsx(i.Fragment,{children:t.map((e,n)=>{const s=Ee(e);if(s==="divider")return i.jsx(j,{},n);if(s==="option"){const{type:r,...o}=e;return i.jsx(b,{...o},o.value)}if(s==="group"){const{type:r,children:o,...l}=e;return i.jsx(N,{...l,children:o.map((p,y)=>i.jsx(b,{...p},y))},n)}})})}P.displayName="OptionRenderer";b.__docgenInfo={description:"",methods:[],displayName:"Option"};P.__docgenInfo={description:"",methods:[],displayName:"OptionRenderer",props:{options:{required:!0,tsType:{name:"Array",elements:[{name:"Option"}],raw:"Option[]"},description:""}}};const k="button[data-option]:not([disabled])",we='button[aria-selected="true"]:not([disabled])';function je(t,e){if(!t||!e||!e)return;const n=e.querySelectorAll(k);for(let s=0;s<n.length;s++)if(n[s].getAttribute("data-option")===t)return n[s].getAttribute("data-option-label")||void 0}function Ne(t,e){if(!t||!e)return;const n=e.querySelectorAll(k);for(let s=0;s<n.length;s++)if(n[s].getAttribute("data-option")===t)return n[s].querySelector("svg:nth-child(2)")||void 0}function Pe(t){return t.querySelectorAll(k)}function Le(t){return t.querySelectorAll(we)}const R=u.forwardRef(({children:t,id:e,name:n,size:s,hasError:r,options:o,placeholder:l,disabled:p,value:y,onChange:x,defaultValue:O,isDisplayedForTesting:_,...I},B)=>{const L=F(e),[$,G]=u.useState(""),V=`${L}-listbox`,f=ge({value:y,onChange:x,defaultValue:O},{onChangeKey:"onChange",valueKey:"value",defaultValueKey:"defaultValue",selector:a=>a.target.value}),[m,C]=u.useState(_===void 0?!1:_),{refs:d,floatingStyles:W,context:Z}=oe({placement:"bottom-start",open:m,onOpenChange:C,whileElementsMounted:re,middleware:[ae(4),le(),ue({apply({rects:a,elements:g,availableHeight:q}){Object.assign(g.floating.style,{maxHeight:`${q}px`,minWidth:`${a.reference.width}px`})}})]}),J=u.useCallback(a=>{if(a){const g=a.getAttribute("id");g&&G(g)}d.reference.current.focus()},[]),Q=de(Z),{getReferenceProps:X,getFloatingProps:Y}=ce([Q]),v=ye({getAllItems:Pe,getSelectedItems:Le,isOpen:m,onOpenChange:a=>C(a),onChange:J});u.useEffect(()=>(v.isOpen=m,d.floating&&(v.listbox=d.floating.current||void 0),d.reference&&(v.setElement(d.reference.current||void 0),m&&d.reference.current.focus()),v.onEnter=a=>{if(a){const g=a.getAttribute("data-option");f.onChange({target:{name:n,value:g}})}else f.value?f.onChange({target:{name:n,value:""}}):document.body.focus()},v.onChange=a=>{if(a){const g=a.getAttribute("id");g&&G(g)}},m&&d.floating.current&&(f.value===void 0?v.focusOnFirst():v.focusOnFirstSelected()),()=>{v.setElement()}),[m]);const M=X();return i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"hidden",value:f.value,name:n,ref:B}),i.jsx(E,{...I,hasError:r,"aria-activedescendant":$,placeholder:l,isOpen:m,size:s,value:f.value,label:je(f.value,d.floating.current),iconElement:Ne(f.value||"",d.floating.current),id:L,"aria-controls":V,disabled:p,...M,onClick:()=>{C(!m),m&&d.reference.current&&d.reference.current.focus()},ref:d.setReference}),i.jsx(pe,{children:i.jsx(w,{tabIndex:-1,ref:d.setFloating,onClick:a=>{if(C(!1),a){const q=a.target.closest("button[data-option]");if(q){const ee=q.getAttribute("data-option");f.onChange({target:{name:n,value:ee}})}}},style:m?W:{display:"none"},...Y(),"aria-labelledby":L,id:V,children:i.jsxs(K.Provider,{value:f.value,children:[o&&i.jsx(P,{options:o}),t]})})})]})});R.displayName="SelectFloating";R.__docgenInfo={description:"",methods:[],displayName:"SelectFloating",props:{isDisplayedForTesting:{required:!1,tsType:{name:"boolean"},description:""},hasError:{required:!1,tsType:{name:"boolean"},description:""},options:{required:!1,tsType:{name:"Array",raw:'OptionRendererProps["options"]'},description:"@deprecated: use Select.OptionRenderer instead"},size:{required:!1,tsType:{name:"union",raw:'"default" | "small"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"small"'}]},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"string"},description:""},defaultValue:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: ChangeEvent) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  target: {
    name: string;
    value: string;
  };
}`,signature:{properties:[{key:"target",value:{name:"signature",type:"object",raw:`{
  name: string;
  value: string;
}`,signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}}]},required:!0}}]}},name:"e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactNode"},description:""}}};function U({id:t,label:e,helpText:n,errorMessages:s,isError:r,hasError:o,...l}){const p=F(t),{fieldProps:y,ariaProps:x}=se({label:e,helpText:n});return i.jsx(ie,{htmlFor:p,label:e,helpText:n,errorMessages:s,isError:r||o||((s==null?void 0:s.length)||0)>0,...y,children:i.jsx(R,{id:p,hasError:r||o||((s==null?void 0:s.length)||0)>0,...x,...l})})}U.__docgenInfo={description:"",methods:[],displayName:"Select",props:{isDisplayedForTesting:{required:!1,tsType:{name:"boolean"},description:""},hasError:{required:!1,tsType:{name:"boolean"},description:""},options:{required:!1,tsType:{name:"Array",raw:'OptionRendererProps["options"]'},description:"@deprecated: use Select.OptionRenderer instead"},size:{required:!1,tsType:{name:"union",raw:'"default" | "small"',elements:[{name:"literal",value:'"default"'},{name:"literal",value:'"small"'}]},description:""},placeholder:{required:!1,tsType:{name:"string"},description:""},value:{required:!1,tsType:{name:"string"},description:""},defaultValue:{required:!1,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: ChangeEvent) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  target: {
    name: string;
    value: string;
  };
}`,signature:{properties:[{key:"target",value:{name:"signature",type:"object",raw:`{
  name: string;
  value: string;
}`,signature:{properties:[{key:"name",value:{name:"string",required:!0}},{key:"value",value:{name:"string",required:!0}}]},required:!0}}]}},name:"e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactNode"},description:""}}};const We={Select:U,Combobox:E,Listbox:w,Option:b,OptGroup:N,Divider:j,OptionRenderer:P};export{We as S};
